# 内核内存分配器基本思想

* 内核内存分配

![1532251341090.png](image/1532251341090.png)


![1532251364038.png](image/1532251364038.png)

![1532251395953.png](image/1532251395953.png)

* 改进：一次读取一个cache line，64*8bits；每8字节判断是否有非0，并使用bsr等指令；缓存上次分配对象对应地bit处，从该处开始查找。一是该处很可能已在cache中，二是该处后面的对象很可能空闲

![1532251579711.png](image/1532251579711.png)

![1532251591413.png](image/1532251591413.png)

![1532251615956.png](image/1532251615956.png)

* 对于64*8bits对象数的内存池，一次就可以全部进入cache，下一次访问时在cache中的概率大


![1532251654709.png](image/1532251654709.png)

![1532251665242.png](image/1532251665242.png)

![1532251691671.png](image/1532251691671.png)


















## END
